---
layout: post
title: 
key: eap功能介绍-jxls导出
tags: eap
---

## 导出jxls所涉及到的技能点

* servlet规范
* http协议的了解
* view ViewResolver 接口理解

为了应对复杂的excel导出,比如跨行,跨列,合并单元格等复杂操作.再使用poi操作,会很麻烦,现集成jxls进行导出操作.

## 使用

1. 新建一个@RequestMappping方法,并指定exportFileName

```java
@RequestMapping("1")
public ModelAndView test(){
    return new ModelAndView("jxls")
        .addObject("good",2)
        .addObject("title","一二三四")
        .addObject("exportFileName","测试");
}
```

jxls导出使用模板view接口进行处理,之前的导出配置表头,数据等已经在模板中定义了,但是导出的文件名因为字符编码的问题,最好通过`addObject("exportFileName","测试");`进行指定,如果不指定,取ModelAndView 的viewName 作为导出文件名(如果有路径,会进行处理) 比如上例的代码(没有最后一行`exportFileName`key的添加) 导出的文件名将会是 `jxls.xls`.

2. 新建一个excel模板

||A|B|
|--|--|--|
|1||${title}|
|2|${good}|${ss}|

在A1单元格添加批注`jx:area(lastCell="D3")` 设置单元格模板范围

3. 浏览器访问

浏览器访问`http(s)://ip:port/.../1.sp`.这样访问是会报错的,需要添加参数值`export=jxls`.

浏览器提示下载文件 文件名是测试.xls

4. 导出的文件查看

||A|B|
|--|--|--|
|1||一二三四|
|2|2||

这是模板替换以后生成的文件内容.因为在ModelAndView的model里没有提供变量`ss`,所以会在控制台报错,这种错误不影响文件的生成,但应该避免.

## 实现原理

待续

## 参考链接

>[java使用jxls导出excel功能](http://blog.csdn.net/xiejx618/article/details/38906683)

>[Jxls+Spring MVC实现Excel导出](http://blog.csdn.net/zjl103/article/details/49666101)

>[使用 jxls2.X 导出excel文件](http://blog.csdn.net/lnktoking/article/details/52932679)

>[jxls2.3-简明教程](https://www.cnblogs.com/klguang/p/6425422.html)